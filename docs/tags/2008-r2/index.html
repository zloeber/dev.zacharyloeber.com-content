<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code,cloud,Azure,AWS,Kubernetes,Docker">
        <meta name="generator" content="Hugo 0.59.1" />
        <title> 2008 R2 | Zachary Loeber</title>
        <meta name="description" content="2008 R2 - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="2008 R2">
        <meta itemprop="description" content="2008 R2 - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="2008 R2">
        <meta property="og:description" content="2008 R2 - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="https://dev.zacharyloeber.com/tags/2008-r2/">
        <meta property="og:site_name" content="Zachary Loeber"><meta property="og:type" content="website">
        <link rel="icon" type="image/png" href="https://dev.zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://dev.zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	
	  <link href="https://dev.zacharyloeber.com/tags/2008-r2/" rel="alternate" type="application/rss+xml" title="Zachary Loeber" />
	  <link href="https://dev.zacharyloeber.com/tags/2008-r2/" rel="feed" type="application/rss+xml" title="Zachary Loeber" />
	

        
        
        
        
        <link rel="stylesheet" href="https://dev.zacharyloeber.com/sass/combined.min.5f50be91a665634f9dfed5900bc388393fc430e3369d58e73b8375457a6df832.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="https://dev.zacharyloeber.com/" target="">Home</a></li>
                
            
                
                    <li><a href="https://dev.zacharyloeber.com/page/about/">About</a></li>
                
            
                
                    <li><a href="https://dev.zacharyloeber.com/page/about-me/">About Me</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="https://dev.zacharyloeber.com/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="https://dev.zacharyloeber.com/">Zachary Loeber</a></h3>
            
                <span class="subtitle">The personal website of Zachary Loeber.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
    
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://dev.zacharyloeber.com/blog/2013/10/06/retrieve-remote-scheduled-task-information-with-powershell/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://dev.zacharyloeber.com/blog/2013/10/06/retrieve-remote-scheduled-task-information-with-powershell/">Retrieve Remote Scheduled Task Information With Powershell</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2013-10-06</span>
            
        

        
            <span class="readingTime">2 min read</span>
        

        
            <span class="categories">
                
                    <a href="https://dev.zacharyloeber.com/categories/microsoft">Microsoft</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/powershell">Powershell</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="https://dev.zacharyloeber.com/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>This function uses multiple runspaces with along with COM objects to gather information about the scheduled tasks of remote systems. Getting this to work with alternate credentials may be possible but I wasn’t able to discern a usable method to make it happen so I resorted to PSremoting. What this means is that this script will work against multiple remote systems which do not have psremoting enabled as long as you are running the script with an account that has administrative rights to them. If you do pass a credential to the function then psremoting will be used instead. You can also force psremoting to be used if you are using that across the board in your environment.</p>

<p>This function was constructed in a way where it will utilize multiple runspaces along with PSremoting as the remote access method (one per invoked scriptblock). This comes at a slight performance hit in comparison to just running invoke-command and passing it all the systems in one command (at least in my limited testing of no more than several machines).  If all you use in your environment is PSremoting it would take a nominal amount of effort to strip just the scriptblock from this function for a direct call from invoke-command.</p>

<p>The one aspect about this script I regret is the inability to get scheduled tasks from a remote system which is not setup for PSremoting with a different credential. I suppose a third method of using wmi to execute a remote command (schtasks) which gets piped to a file for remote parsing would be feasible as well. But you don’t really get near as much scheduled task information that way and I really wanted to start incorporating PSremoting anyway. Besides, that can be done by anyone with a simple parsing function (in conjunction with the scripts <a href="https://dev.zacharyloeber.com/2013/09/19/gather-remote-command-results-with-powershell/">I already released to facilitate remote command output retrieval</a>).</p>

<h3 id="version-history">Version History</h3>

<p>1.0.0 &#8211; 10/04/2013</p>

<ul>
<li>Initial release</li>
</ul>

<h3 id="notes">Notes</h3>

<p>I used code from a few sources to create this script;</p>

<ul>
<li><a href="http://p0w3rsh3ll.wordpress.com/2012/10/22/working-with-scheduled-tasks/">http://p0w3rsh3ll.wordpress.com/2012/10/22/working-with-scheduled-tasks/</a></li>
<li><a href="http://gallery.technet.microsoft.com/Get-Scheduled-tasks-from-3a377294">http://gallery.technet.microsoft.com/Get-Scheduled-tasks-from-3a377294</a></li>
</ul>

<p>I was unable to find several of the Task last exit codes. A good number of them from the following source have been included tough;</p>

<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa383604(v=vs.85).aspx">http://msdn.microsoft.com/en-us/library/windows/desktop/aa383604(v=vs.85).aspx</a></li>
</ul>

<h3 id="downloads">Downloads</h3>

<p><a href="http://gallery.technet.microsoft.com/Retrieve-Remote-Scheduled-72985b8f">Download this script from the technet gallery.</a></p>
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="https://dev.zacharyloeber.com/tags/2008-r2">2008 R2</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/microsoft">Microsoft</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/powershell">Powershell</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/scripting">Scripting</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/sysadmin">Sysadmin</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/system-administration">System Administration</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/windows">Windows</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://dev.zacharyloeber.com/blog/2013/09/19/gather-remote-command-results-with-powershell/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://dev.zacharyloeber.com/blog/2013/09/19/gather-remote-command-results-with-powershell/">Gather Remote Command Results With Powershell</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2013-09-19</span>
            
        

        
            <span class="readingTime">3 min read</span>
        

        
            <span class="categories">
                
                    <a href="https://dev.zacharyloeber.com/categories/microsoft">Microsoft</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/networking">Networking</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/powershell">Powershell</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/security">Security</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="https://dev.zacharyloeber.com/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>Send a remote command using wmi, alternate credentials, and multiple runspaces then retrieve the results serially using mapped secure channels to the remote host. The remote command execution function supports custom timeout parameters in case of wmi problems and returns the remote tmp file information containing the command results. You can view verbose information on each runspace thread in realtime with the -Verbose option.</p>

        
            <a href="https://dev.zacharyloeber.com/blog/2013/09/19/gather-remote-command-results-with-powershell/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="https://dev.zacharyloeber.com/tags/2008-r2">2008 R2</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/microsoft">Microsoft</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/network-administration">network administration</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/powershell">Powershell</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/scripting">Scripting</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/sysadmin">Sysadmin</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/system-administration">System Administration</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/windows">Windows</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    
        <div class="article-wrapper u-cf">
            
                <a class="bubble" href="https://dev.zacharyloeber.com/blog/2013/09/14/get-remote-shadow-volume-information-with-powershell/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://dev.zacharyloeber.com/blog/2013/09/14/get-remote-shadow-volume-information-with-powershell/">Get Remote Shadow Volume Information With Powershell</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2013-09-15</span>
            
        

        
            <span class="readingTime">1 min read</span>
        

        
            <span class="categories">
                
                    <a href="https://dev.zacharyloeber.com/categories/microsoft">Microsoft</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/powershell">Powershell</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/storage">Storage</a>
                
                    <a href="https://dev.zacharyloeber.com/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="https://dev.zacharyloeber.com/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>Gather the remote shadow volume information for one or more systems using wmi, alternate credentials, and multiple runspaces. Function supports custom timeout parameters in case of wmi problems and returns shadow volume information, shadow copies, their providers, and settings. You can view verbose information on each runspace thread in realtime with the -Verbose option.</p>

        
            <a href="https://dev.zacharyloeber.com/blog/2013/09/14/get-remote-shadow-volume-information-with-powershell/" class="more">Continue reading</a>
        
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="https://dev.zacharyloeber.com/tags/2008-r2">2008 R2</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/microsoft">Microsoft</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/monitoring">Monitoring</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/network-administration">network administration</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/networking">Networking</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/powershell">Powershell</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/scripting">Scripting</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/sysadmin">Sysadmin</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/system-administration">System Administration</a>
                
                    <a href="https://dev.zacharyloeber.com/tags/windows">Windows</a>
                
            </div>
        </div>
    

    
</div>

</article>

            
        </div>
    

    
    <div class="paginator">
        
            <a href="https://dev.zacharyloeber.com/tags/2008-r2/page/2/" class="older"><i class="fa fa-angle-double-left"></i> Older posts</a>
        

        
    </div>



        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="https://dev.zacharyloeber.com/posts/devops-blog-migration-to-hugo/">Devops Blog Migration to Hugo</a>
                    </li>
                
                    <li>
                        <a href="https://dev.zacharyloeber.com/posts/devops-blog-migration-to-hugo/">Devops Blog Migration to Hugo</a>
                    </li>
                
                    <li>
                        <a href="https://dev.zacharyloeber.com/content/posts/site-move/">Site Move</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="https://dev.zacharyloeber.com/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="https://dev.zacharyloeber.com/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="https://dev.zacharyloeber.com/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="https://dev.zacharyloeber.com/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="https://dev.zacharyloeber.com/categories/networking">Networking (53)</a>
                    </li>
                
                    <li>
                        <a href="https://dev.zacharyloeber.com/categories/active-directory">Active directory (44)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2019
                
                by Zachary Loeber
            </a>
	    -
		<a href="https://dev.zacharyloeber.com/tags/2008-r2/index.xml">RSS</a>
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="https://dev.zacharyloeber.com/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="https://dev.zacharyloeber.com/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
